The code will be re-organized via adding the comments. 
